#!/usr/bin/env bash

usage="NAME
      new_script - create new script in tools dir and edit it in vim

SYNOPSIS
      new_script [-h] -n|--name

ARGUMENTS

       -n name (required)
          Name of the script you would like to create
          Example:
              ./new_script -n my_script
"

while test $# -gt 0; do
	  case "$1" in
        -h|--help|-\?)
            echo "$usage" >&2
            exit
            ;;
        -n|--name)
            name=$2
            shift
            ;;
        \?)
            echo "Invalid option: -$OPTARG" >&2
            exit 1
            ;;
        *)
            break
    esac
    shift
done

if [[ -z "${name}" ]]; then
    echo "${usage}"
    exit 1
fi

tool_dir=$HOME/.local/bin/tools
full=${tool_dir}/$name
if [[ -f "${full}" ]]; then
    echo "Error: ${name} already exists in ${tool_dir}"
    echo "Edit $name? y/n"
    read answer
    if [[ "${answer}" == "y" ]]; then
        vim "${full}"
    fi
    exit 0
fi

echo "#!/usr/bin/env bash" > "${full}"

chmod +x "${full}"

vim "${full}"
